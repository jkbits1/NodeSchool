<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title></title>
</head>
<body>

  <main>
    <!--<form action="">-->

    <!--</form>-->

    <label for="fileName">Choose a file:</label>
    <input type="file" id="fileName" onchange="processFile(this.files)"/>

    <div id="response">

    </div>


  </main>

  <script>
    function processFile(files) {
      if (files) {
//        files.forEach(function (val) {
//          console.log(val);
//        });

        sendFile(files[0]);
      }
    }

    function sendFile (file) {

//      var uri = "http://localhost:8080/upload";
      var uri = "http://127.0.0.1:9090/upload";
//      var uri = "http://localhost:9090/upload";
//      var uri = "http://0.0.0.0:9090/upload";

      var xhr = new XMLHttpRequest();
      var fd = new FormData();

      xhr.open("POST", uri, true);

      xhr.onreadystatechange = function() {
        if (xhr.readyState == 4 && xhr.status == 200) {
          var response = JSON.stringify(xhr.responseText);

          console.log(response);

          var outputDiv = document.getElementById("response");

          outputDiv.appendChild(
            document.createTextNode(response)) ;
        }
      };

      fd.append("file", file);
      fd.append("description", "text file");
      xhr.send(fd);
    }
  </script>

</body>
</html>